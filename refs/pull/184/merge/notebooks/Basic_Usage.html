
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic usage &#8212; SciKeras 0.2.1 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/insipid.css" type="text/css" />

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer src="../_static/insipid.js"></script>
    <script defer src="../_static/insipid-sidebar.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MLPClassifier and MLPRegressor in SciKeras" href="MLPClassifier_MLPRegressor.html" />
    <link rel="prev" title="Tutorials" href="../tutorials.html" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
  </head>
  <body class="sidebar-visible">
    <script type="text/javascript">
        (function() {
            var $body = $(document.body);
            $body.addClass('js');
            $body.addClass('sidebar-resizing');  // avoid transitions on load
            $body.removeClass('sidebar-visible');
            try {
                var sidebar = localStorage.getItem('sphinx-sidebar');
                if (sidebar === 'visible') {
                    $body.addClass('sidebar-visible');
                }
                var sidebar_width = localStorage.getItem('sphinx-sidebar-width');
                if (sidebar_width) {
                    $(':root').css('--sidebar-width', sidebar_width);
                }
            } catch(e) {
            }
        })();
    </script>
    <header id="topbar-placeholder">
      <div id="topbar">
        <div id="titlebar">
          <div class="buttons">
            <button id="sidebar-button" type="button" aria-controls="sphinxsidebar" accesskey="M">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"/></svg>
            </button>
            <button id="search-button" type="button" title="Search" aria-label="Search" aria-expanded="false" aria-controls="search-form" accesskey="S">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
            </button>
          </div>
          <div class="title">
            <a class="parent" href="../tutorials.html" accesskey="U">Tutorials</a>
            <a class="top" href="#">Basic usage</a>
          </div>
          <div class="buttons">
            <button id="fullscreen-button" type="button" aria-hidden="true">
              <span class="enable">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M212.686 315.314L120 408l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C10.697 480 0 469.255 0 456V344c0-21.382 25.803-32.09 40.922-16.971L72 360l92.686-92.686c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.249 6.248 6.249 16.378 0 22.627zm22.628-118.628L328 104l-32.922-31.029C279.958 57.851 290.666 32 312.048 32h112C437.303 32 448 42.745 448 56v112c0 21.382-25.803 32.09-40.922 16.971L376 152l-92.686 92.686c-6.248 6.248-16.379 6.248-22.627 0l-25.373-25.373c-6.249-6.248-6.249-16.378 0-22.627z"/></svg>
              </span>
              <span class="disable">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M4.686 427.314L104 328l-32.922-31.029C55.958 281.851 66.666 256 88.048 256h112C213.303 256 224 266.745 224 280v112c0 21.382-25.803 32.09-40.922 16.971L152 376l-99.314 99.314c-6.248 6.248-16.379 6.248-22.627 0L4.686 449.941c-6.248-6.248-6.248-16.379 0-22.627zM443.314 84.686L344 184l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C234.697 256 224 245.255 224 232V120c0-21.382 25.803-32.09 40.922-16.971L296 136l99.314-99.314c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.248 6.248 6.248 16.379 0 22.627z"/></svg>
              </span>
            </button>
            <a href="https://github.com/adriangb/scikeras/" title="Github">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
            </a>
          </div>
        </div>
        <div id="searchbox" role="search">
          <form id="search-form" class="search" style="display: none" action="../search.html" method="get">
            <input type="search" name="q" placeholder="Search ..." />
            <button>Go</button>
          </form>
        </div>
      </div>
    </header>
    <nav>
      <a href="../tutorials.html" class="nav-icon previous" title="previous:&#13;Tutorials" aria-label="Previous topic" accesskey="P" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>
      </a>
      <a href="MLPClassifier_MLPRegressor.html" class="nav-icon next" title="next:&#13;MLPClassifier and MLPRegressor in SciKeras" aria-label="Next topic" accesskey="N" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg>
      </a>
    </nav>

    <nav class="relbar">
      <a class="previous" href="../tutorials.html" aria-label="Previous topic" >
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"/></svg>
        </div>
        <div class="title">
          <span class="text">
            <span class="direction">previous</span>
            Tutorials
          </span>
        </div>
      </a>
      <a class="next" href="MLPClassifier_MLPRegressor.html" aria-label="Next topic" >
        <div class="title">
          <span class="text">
            <span class="direction">next</span>
            MLPClassifier and MLPRegressor in SciKeras
          </span>
        </div>
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg>
        </div>
      </a>
    </nav>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<a href="https://colab.research.google.com/github/adriangb/scikeras/blob/docs-deploy/refs/heads/master/notebooks/Basic_Usage.ipynb"><img src="https://www.tensorflow.org/images/colab_logo_32px.png">Run in Google Colab</a><div class="section" id="Basic-usage">
<h1>Basic usage<a class="headerlink" href="#Basic-usage" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">SciKeras</span></code> is designed to maximize interoperability between <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> and <code class="docutils literal notranslate"><span class="pre">Keras/TensorFlow</span></code>. The aim is to keep 99% of the flexibility of <code class="docutils literal notranslate"><span class="pre">Keras</span></code> while being able to leverage most features of <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>. Below, we show the basic usage of <code class="docutils literal notranslate"><span class="pre">SciKeras</span></code> and how it can be combined with <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.</p>
<p>This notebook shows you how to use the basic functionality of <code class="docutils literal notranslate"><span class="pre">SciKeras</span></code>.</p>
<div class="section" id="Table-of-contents">
<h2>Table of contents<a class="headerlink" href="#Table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#1.-Setup">1. Setup</a></p></li>
<li><p><a class="reference external" href="#2.-Training-a-classifier-and-making-predictions">2. Training a classifier and making predictions</a></p></li>
<li><p><a class="reference external" href="#2.1-A-toy-binary-classification-task">2.1 A toy binary classification task</a></p></li>
<li><p><a class="reference external" href="#2.2-Definition-of-the-Keras-classification-Model">2.2 Definition of the Keras classification Model</a></p></li>
<li><p><a class="reference external" href="#2.3-Defining-and-training-the-neural-net-classifier">2.3 Defining and training the neural net classifier</a></p></li>
<li><p><a class="reference external" href="#2.4-Making-predictions-classification">2.4 Making predictions, classification</a></p></li>
<li><p><a class="reference external" href="#3.-Training-a-regressor">3 Training a regressor</a></p></li>
<li><p><a class="reference external" href="#3.1-A-toy-regression-task">3.1 A toy regression task</a></p></li>
<li><p><a class="reference external" href="#3.2-Definition-of-the-Keras-regression-Model">3.2 Definition of the Keras regression Model</a></p></li>
<li><p><a class="reference external" href="#3.3-Defining-and-training-the-neural-net-regressor">3.3 Defining and training the neural net regressor</a></p></li>
<li><p><a class="reference external" href="#3.4-Making-predictions-regression">3.4 Making predictions, regression</a></p></li>
<li><p><a class="reference external" href="#4.-Saving-and-loading-a-model">4. Saving and loading a model</a></p></li>
<li><p><a class="reference external" href="#4.1-Saving-the-whole-model">4.1 Saving the whole model</a></p></li>
<li><p><a class="reference external" href="#4.2-Saving-using-Keras-saving-methods">4.2 Saving using Keras’ saving methods</a></p></li>
<li><p><a class="reference external" href="#5.-Usage-with-an-sklearn-Pipeline">5. Usage with an sklearn Pipeline</a></p></li>
<li><p><a class="reference external" href="#6.-Callbacks">6. Callbacks</a></p></li>
<li><p><a class="reference external" href="#7.-Usage-with-sklearn-GridSearchCV">7. Usage with sklearn GridSearchCV</a></p></li>
<li><p><a class="reference external" href="#7.1-Special-prefixes">7.1 Special prefixes</a></p></li>
<li><p><a class="reference external" href="#7.2-Performing-a-grid-search">7.2 Performing a grid search</a></p></li>
</ul>
</div>
<div class="section" id="1.-Setup">
<h2>1. Setup<a class="headerlink" href="#1.-Setup" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">scikeras</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>python -m pip install scikeras
</pre></div>
</div>
</div>
<p>Silence TensorFlow logging to keep output succinct.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="n">get_logger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="s1">&#39;ERROR&#39;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Setting the random state for TF&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scikeras.wrappers</span> <span class="kn">import</span> <span class="n">KerasClassifier</span><span class="p">,</span> <span class="n">KerasRegressor</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.-Training-a-classifier-and-making-predictions">
<h2>2. Training a classifier and making predictions<a class="headerlink" href="#2.-Training-a-classifier-and-making-predictions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="2.1-A-toy-binary-classification-task">
<h3>2.1 A toy binary classification task<a class="headerlink" href="#2.1-A-toy-binary-classification-task" title="Permalink to this headline">¶</a></h3>
<p>We load a toy classification task from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">n_informative</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((1000, 20), (1000,), 0.5)
</pre></div></div>
</div>
</div>
<div class="section" id="2.2-Definition-of-the-Keras-classification-Model">
<h3>2.2 Definition of the Keras classification Model<a class="headerlink" href="#2.2-Definition-of-the-Keras-classification-Model" title="Permalink to this headline">¶</a></h3>
<p>We define a vanilla neural network with.</p>
<p>Because we are dealing with 2 classes, the output layer can be constructed in two different ways:</p>
<ol class="arabic simple">
<li><p>Single unit with a <code class="docutils literal notranslate"><span class="pre">&quot;sigmoid&quot;</span></code> nonlinearity. The loss must be <code class="docutils literal notranslate"><span class="pre">&quot;binary_crossentropy&quot;</span></code>.</p></li>
<li><p>Two units (one for each class) and a <code class="docutils literal notranslate"><span class="pre">&quot;softmax&quot;</span></code> nonlinearity. The loss must be <code class="docutils literal notranslate"><span class="pre">&quot;sparse_categorical_crossentropy&quot;</span></code>.</p></li>
</ol>
<p>In this example, we choose the first option, which is what you would usually do for binary classification. The second option is usually reserved for when you have &gt;2 classes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>


<span class="k">def</span> <span class="nf">get_clf</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="p">,</span> <span class="n">dropout</span><span class="p">):</span>
    <span class="n">n_features_in_</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_features_in_&quot;</span><span class="p">]</span>
    <span class="n">n_classes_</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_classes_&quot;</span><span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_features_in_</span><span class="p">,)))</span>
    <span class="k">for</span> <span class="n">hidden_layer_size</span> <span class="ow">in</span> <span class="n">hidden_layer_sizes</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">hidden_layer_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2.3-Defining-and-training-the-neural-net-classifier">
<h3>2.3 Defining and training the neural net classifier<a class="headerlink" href="#2.3-Defining-and-training-the-neural-net-classifier" title="Permalink to this headline">¶</a></h3>
<p>We use <code class="docutils literal notranslate"><span class="pre">KerasClassifier</span></code> because we’re dealing with a classifcation task. The first argument should be a callable returning a <code class="docutils literal notranslate"><span class="pre">Keras.Model</span></code>, in this case, <code class="docutils literal notranslate"><span class="pre">get_clf</span></code>. As additional arguments, we pass the number of loss function (required) and the optimizer, but the later is optional. We must also pass all of the arguments to <code class="docutils literal notranslate"><span class="pre">get_clf</span></code> as keyword arguments to <code class="docutils literal notranslate"><span class="pre">KerasClassifier</span></code> if they don’t have a default value in <code class="docutils literal notranslate"><span class="pre">get_clf</span></code>. Note that if you do not pass an argument to
<code class="docutils literal notranslate"><span class="pre">KerasClassifier</span></code>, it will not be avilable for hyperparameter tuning. Finally, we also pass <code class="docutils literal notranslate"><span class="pre">random_state=0</span></code> for reproducible results.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">scikeras.wrappers</span> <span class="kn">import</span> <span class="n">KerasClassifier</span>


<span class="n">clf</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">get_clf</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;binary_crossentropy&quot;</span><span class="p">,</span>
    <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,),</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>As in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>, we call <code class="docutils literal notranslate"><span class="pre">fit</span></code> passing the input data <code class="docutils literal notranslate"><span class="pre">X</span></code> and the targets <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
32/32 [==============================] - 1s 1ms/step - loss: 0.9409
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KerasClassifier(
        model=&lt;function get_clf at 0x7f2319960310&gt;
        build_fn=None
        warm_start=False
        random_state=None
        optimizer=rmsprop
        loss=binary_crossentropy
        metrics=None
        batch_size=None
        verbose=1
        callbacks=None
        validation_split=0.0
        shuffle=True
        run_eagerly=False
        epochs=1
        hidden_layer_sizes=(100,)
        dropout=0.5
        class_weight=None
)
</pre></div></div>
</div>
<p>Also, as in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>, you may call <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> on the fitted model.</p>
</div>
<div class="section" id="2.4-Making-predictions,-classification">
<h3>2.4 Making predictions, classification<a class="headerlink" href="#2.4-Making-predictions,-classification" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">y_pred</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1/1 [==============================] - 0s 74ms/step
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([0, 0, 0, 0, 0])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_proba</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">y_proba</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1/1 [==============================] - 0s 26ms/step
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0.50461197, 0.49538806],
       [0.5218572 , 0.4781428 ],
       [0.7269551 , 0.27304488],
       [0.71093863, 0.28906137],
       [0.8442361 , 0.15576392]], dtype=float32)
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="3-Training-a-regressor">
<h2>3 Training a regressor<a class="headerlink" href="#3-Training-a-regressor" title="Permalink to this headline">¶</a></h2>
<div class="section" id="3.1-A-toy-regression-task">
<h3>3.1 A toy regression task<a class="headerlink" href="#3.1-A-toy-regression-task" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>


<span class="n">X_regr</span><span class="p">,</span> <span class="n">y_regr</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">n_informative</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_regr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_regr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_regr</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">y_regr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((1000, 20), (1000,), -649.0148244404172, 615.4505181286091)
</pre></div></div>
</div>
</div>
<div class="section" id="3.2-Definition-of-the-Keras-regression-Model">
<h3>3.2 Definition of the Keras regression Model<a class="headerlink" href="#3.2-Definition-of-the-Keras-regression-Model" title="Permalink to this headline">¶</a></h3>
<p>Again, define a vanilla neural network. The main difference is that the output layer always has a single unit and does not apply any nonlinearity.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">get_reg</span><span class="p">(</span><span class="n">meta</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="p">,</span> <span class="n">dropout</span><span class="p">):</span>
    <span class="n">n_features_in_</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;n_features_in_&quot;</span><span class="p">]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_features_in_</span><span class="p">,)))</span>
    <span class="k">for</span> <span class="n">hidden_layer_size</span> <span class="ow">in</span> <span class="n">hidden_layer_sizes</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">hidden_layer_size</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3.3-Defining-and-training-the-neural-net-regressor">
<h3>3.3 Defining and training the neural net regressor<a class="headerlink" href="#3.3-Defining-and-training-the-neural-net-regressor" title="Permalink to this headline">¶</a></h3>
<p>Training a regressor is almost the same as training a classifier. Mainly, we use <code class="docutils literal notranslate"><span class="pre">KerasRegressor</span></code> instead of <code class="docutils literal notranslate"><span class="pre">KerasClassifier</span></code> (this is the same terminology as in <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>). We also change the loss function to <code class="docutils literal notranslate"><span class="pre">KerasRegressor.r_squared</span></code>. SciKeras provides this loss function because most of the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> ecosystem expects <code class="docutils literal notranslate"><span class="pre">R^2</span></code> as the loss function, but Keras does not have a default implementation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">scikeras.wrappers</span> <span class="kn">import</span> <span class="n">KerasRegressor</span>


<span class="n">reg</span> <span class="o">=</span> <span class="n">KerasRegressor</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">get_reg</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">KerasRegressor</span><span class="o">.</span><span class="n">r_squared</span><span class="p">,</span>
    <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,),</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_regr</span><span class="p">,</span> <span class="n">y_regr</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
32/32 [==============================] - 1s 1ms/step - loss: -0.0326
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
KerasRegressor(
        model=&lt;function get_reg at 0x7f230e75daf0&gt;
        build_fn=None
        warm_start=False
        random_state=None
        optimizer=rmsprop
        loss=&lt;function KerasRegressor.r_squared at 0x7f231a712940&gt;
        metrics=None
        batch_size=None
        verbose=1
        callbacks=None
        validation_split=0.0
        shuffle=True
        run_eagerly=False
        epochs=1
        hidden_layer_sizes=(100,)
        dropout=0.5
)
</pre></div></div>
</div>
</div>
<div class="section" id="3.4-Making-predictions,-regression">
<h3>3.4 Making predictions, regression<a class="headerlink" href="#3.4-Making-predictions,-regression" title="Permalink to this headline">¶</a></h3>
<p>You may call <code class="docutils literal notranslate"><span class="pre">predict</span></code> or <code class="docutils literal notranslate"><span class="pre">predict_proba</span></code> on the fitted model. For regressions, both methods return the same value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_regr</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">y_pred</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1/1 [==============================] - 0s 46ms/step
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.81634825, -0.761113  , -0.13966595, -0.3599409 , -1.1539853 ],
      dtype=float32)
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="4.-Saving-and-loading-a-model">
<h2>4. Saving and loading a model<a class="headerlink" href="#4.-Saving-and-loading-a-model" title="Permalink to this headline">¶</a></h2>
<p>Save and load either the whole model by using pickle, or use Keras’ specialized save methods on the <code class="docutils literal notranslate"><span class="pre">KerasClassifier.model_</span></code> or <code class="docutils literal notranslate"><span class="pre">KerasRegressor.model_</span></code> attribute that is created after fitting. You will want to use Keras’ model saving utilities if any of the following apply:</p>
<ol class="arabic simple">
<li><p>You wish to save only the weights or only the training configuration of your model.</p></li>
<li><p>You wish to share your model with collaborators. Pickle is a relatively unsafe protocol and it is not recommended to share or load pickle objects publically.</p></li>
<li><p>You care about performance, especially if doing in-memory serialization.</p></li>
</ol>
<p>For more information, see Keras’ <a class="reference external" href="https://www.tensorflow.org/guide/keras/save_and_serialize">saving documentation</a>.</p>
<div class="section" id="4.1-Saving-the-whole-model">
<h3>4.1 Saving the whole model<a class="headerlink" href="#4.1-Saving-the-whole-model" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pickle</span>


<span class="n">bytes_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">reg</span><span class="p">)</span>
<span class="n">new_reg</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">bytes_model</span><span class="p">)</span>
<span class="n">new_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_regr</span><span class="p">);</span>  <span class="c1"># model is still trained</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
32/32 [==============================] - 0s 776us/step
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-8.16348255e-01, -7.61112988e-01, -1.39665946e-01, -3.59940886e-01,
       -1.15398538e+00,  1.48880616e-01, -1.02966237e+00, -1.11557044e-01,
       -1.73542321e+00, -1.10663068e+00, -1.28639624e-01, -1.19301307e+00,
       -1.08206666e+00, -8.53760898e-01, -7.81467795e-01, -8.92227888e-01,
       -1.30221695e-01, -1.41060352e+00, -8.22805882e-01, -7.84779847e-01,
       -8.19814622e-01, -6.90889537e-01, -6.82878673e-01, -1.58014655e-01,
       -1.56526351e+00, -2.87378818e-01, -4.46655393e-01, -9.12756085e-01,
       -1.25913382e-01, -1.77157366e+00, -5.78104079e-01, -4.39484477e-01,
       -1.68117023e+00, -1.11868942e+00, -2.90910210e-02, -1.12581205e+00,
        2.24881265e-02,  3.59721243e-01, -4.82037574e-01, -2.78996497e-01,
       -1.59852695e+00,  7.59287030e-02, -2.46268943e-01, -5.14650270e-02,
       -7.29592681e-01, -1.40968311e+00, -5.17672598e-01, -2.15786025e-01,
       -9.45498943e-01, -1.04057360e+00, -1.64849246e+00, -8.19050595e-02,
       -5.45937493e-02, -4.82360572e-01, -8.25583696e-01, -1.17181718e+00,
       -1.60031998e+00, -1.14215843e-01, -4.60719883e-01, -4.06122416e-01,
       -1.52087355e+00,  1.03453970e+00, -2.97514677e-01, -1.34550214e+00,
       -1.07587111e+00, -3.17203969e-01, -9.61093843e-01, -1.82262194e+00,
       -1.36871600e+00, -4.76631939e-01, -1.00852489e+00, -8.83362651e-01,
        7.47031942e-02,  8.03724527e-02, -9.33077991e-01, -8.55957031e-01,
       -8.82085681e-01, -1.17722011e+00, -5.82837045e-01, -1.39924645e+00,
       -6.60827398e-01,  6.76688373e-01, -2.19338417e-01, -6.33935571e-01,
       -1.20749712e+00,  3.63949537e-01, -1.32085383e+00,  4.26313668e-01,
       -2.00847864e+00,  1.03048205e+00, -1.20087600e+00,  1.52261269e+00,
       -1.14254868e+00, -1.13794363e+00, -1.28038979e+00, -4.60407406e-01,
       -1.28294623e+00, -6.57386601e-01, -5.03631115e-01,  3.19021553e-01,
       -1.75951254e+00,  9.49671745e-01, -1.36504304e+00, -1.29748777e-01,
        5.68378687e-01, -8.57122421e-01,  9.92427692e-02, -4.17450696e-01,
        1.24648310e-01, -1.42080963e+00,  7.66255915e-01, -8.24257612e-01,
        7.03932583e-01,  2.29798838e-01,  6.04978323e-01, -2.49371457e+00,
       -7.93244898e-01, -9.41487610e-01,  6.27706409e-01,  1.86463952e-01,
       -4.19857264e-01, -1.63263544e-01, -1.06696284e+00, -1.22687590e+00,
        6.59758866e-01, -1.38939691e+00, -9.02304053e-01, -1.71620801e-01,
        9.06913042e-01, -1.55954802e+00, -5.10243416e-01, -2.39561617e-01,
       -3.12808245e-01, -2.21856579e-01,  7.45409608e-01, -1.66837430e+00,
       -6.54190421e-01, -5.28152466e-01, -1.41670182e-01, -1.63743484e+00,
       -1.10537219e+00, -3.54655296e-01, -6.87612295e-01,  1.37716305e+00,
       -1.11081564e+00, -1.33129418e+00,  5.36534786e-01, -2.34953928e+00,
       -7.30687737e-01, -7.89408088e-01, -4.34349298e-01,  1.20437598e+00,
       -6.77875876e-01, -1.34129179e+00, -1.09810805e+00, -1.03220177e+00,
        2.07815040e-02, -7.12539554e-01,  5.97766414e-02,  1.61841869e-01,
       -3.10644239e-01, -1.17541289e+00, -2.25368023e+00, -4.93410170e-01,
       -8.44262183e-01,  1.13250971e+00, -5.51696241e-01, -7.73856282e-01,
       -7.84560621e-01, -5.80488265e-01, -6.34763420e-01,  1.01010576e-01,
       -5.98438561e-01, -2.70267427e-01, -4.72268134e-01, -9.09480095e-01,
       -1.16393352e+00, -1.57830819e-01, -2.32411981e-01,  5.31825602e-01,
        5.35385966e-01, -2.12130081e-02, -5.74203849e-01, -2.84755379e-01,
       -1.09082317e+00, -1.91924974e-01, -1.63009238e+00, -9.58564281e-01,
        6.40510380e-01, -1.49329448e+00, -1.18103139e-01, -7.47426808e-01,
       -4.50479686e-02, -5.18794000e-01, -7.29324341e-01, -1.27036107e+00,
        3.47751707e-01, -2.21507645e+00, -8.22521091e-01, -1.90614450e+00,
       -1.52801466e+00, -1.64739645e+00, -1.03527296e+00,  6.69122115e-02,
        3.27000409e-01, -1.75815225e+00, -4.35662001e-01,  2.89131850e-01,
        1.48850679e-01, -2.66630054e-01, -1.18885314e+00, -1.60346866e+00,
       -7.04142511e-01, -1.64754677e+00,  1.11347057e-01, -1.00122917e+00,
       -1.34239122e-01, -9.07903075e-01, -5.64096346e-02, -8.38224947e-01,
       -2.14480758e+00, -2.19600558e+00, -1.55335891e+00,  6.41051590e-01,
       -2.17038560e+00, -6.11406326e-01, -2.70228744e-01, -4.97557491e-01,
       -1.55553043e+00, -1.21162724e+00, -1.64663041e+00,  2.20742330e-01,
       -5.59396088e-01, -5.53458691e-01, -1.79685318e+00, -1.51990131e-01,
        9.59449708e-02, -1.99980915e-01,  7.18084648e-02,  2.64127612e-01,
       -8.58873785e-01, -1.62852108e-01,  6.49862647e-01,  8.33518505e-01,
       -2.26222739e-01, -1.03108549e+00, -2.02059555e+00, -1.53184354e+00,
       -1.12416351e+00, -1.13074672e+00, -1.71474338e+00, -4.69839334e-01,
       -7.23079979e-01,  1.63376942e-01, -9.18874919e-01, -1.24819212e-01,
       -9.11638618e-01, -1.80093920e+00, -1.99775612e+00, -3.46533209e-01,
       -7.36568332e-01, -1.36437857e+00, -1.97071552e+00, -2.91073710e-01,
        4.85541910e-01, -8.16615999e-01,  4.86396819e-01,  3.34695667e-01,
        1.78493023e-01, -1.19794977e+00,  9.68152046e-01, -8.56647849e-01,
       -2.88398534e-01, -6.32375002e-01,  5.83546042e-01, -4.45386827e-01,
       -1.34966385e+00, -3.97691637e-01, -3.17444921e-01, -3.54146063e-01,
       -9.55549359e-01, -1.51051581e+00, -2.27870679e+00, -2.63408637e+00,
       -7.53711224e-01, -4.06258330e-02, -1.00994241e+00, -1.18378019e+00,
       -1.43413559e-01, -4.24882472e-01,  7.21518934e-01, -3.66310805e-01,
        7.28774071e-01, -8.42793524e-01, -1.47665471e-01, -2.69884706e-01,
        5.68477035e-01, -6.87850118e-01, -6.05575919e-01, -4.49718148e-01,
       -1.08279777e+00,  1.06261587e+00, -1.40947416e-01, -1.42877603e+00,
       -6.99364662e-01, -1.95897114e+00, -1.11425424e+00, -5.39766967e-01,
        2.86909670e-01, -7.71316111e-01,  4.70936924e-01, -3.49450439e-01,
       -1.84120372e-01, -9.86588776e-01,  4.69117835e-02, -9.39112782e-01,
       -1.26931012e+00, -9.84142005e-01,  6.68477193e-02, -1.29015195e+00,
        3.52603644e-01, -2.04821897e+00, -5.83409548e-01, -6.52926624e-01,
        3.52540314e-01, -8.34252954e-01, -1.39012063e+00, -2.23198032e+00,
        3.86681169e-01,  7.12709010e-01, -9.27996993e-01, -1.38382483e+00,
       -1.58449531e-01, -8.38725090e-01, -7.92053819e-01, -8.38712215e-01,
       -1.60944507e-01, -7.31482923e-01, -5.44508159e-01,  3.85175318e-01,
       -5.65675676e-01, -8.48588288e-01, -8.72988999e-02, -1.02606952e+00,
       -5.56004524e-01, -1.24116659e+00,  2.79347990e-02, -1.34139717e+00,
       -1.66786563e+00, -1.52211979e-01, -1.30441296e+00, -8.99355650e-01,
       -2.20501709e+00, -7.72160470e-01,  8.61045346e-02, -1.55285344e-01,
       -1.61961651e+00, -1.52251565e+00, -1.27466047e+00, -1.62864670e-01,
       -1.08116615e+00, -1.00664389e+00, -5.05593836e-01,  2.23660752e-01,
       -1.41786885e+00, -9.12046790e-01, -1.28823578e+00, -9.53078985e-01,
       -9.97239113e-01,  5.78588903e-01, -1.14179444e+00, -7.73790896e-01,
       -1.49111414e+00, -4.55887109e-01, -1.15173258e-01,  7.31913626e-01,
        2.71286845e-01,  5.40171623e-01, -1.36604059e+00, -1.07134826e-01,
       -2.02854779e-02, -2.85574174e+00, -3.09647650e-01, -1.96649885e+00,
       -1.49233222e+00, -7.29243696e-01, -6.14066541e-01, -7.41100311e-01,
       -1.21215868e+00,  5.04978299e-02, -1.46659863e+00, -5.72726965e-01,
       -6.28361523e-01, -1.65017390e+00,  1.25359237e-01, -1.16127968e+00,
       -8.97240937e-01,  4.84812528e-01, -6.09797798e-03, -1.74095973e-01,
       -1.35409367e+00, -1.50597858e+00, -9.62406397e-01, -3.49809974e-01,
        5.46406984e-01, -6.69011712e-01, -1.59055018e+00, -2.78018594e+00,
       -1.89081931e+00, -2.41745889e-01,  6.42346777e-03,  1.53268731e+00,
       -4.70244884e-01, -1.26538920e+00, -7.52700090e-01, -7.66196609e-01,
        3.56341213e-01, -1.97348011e+00, -2.12186694e+00, -1.06565487e+00,
        3.67307961e-01,  2.44671211e-01, -1.47820091e+00, -6.64310992e-01,
       -5.60137272e-01, -1.45895648e+00,  1.70430869e-01, -7.34162867e-01,
        3.73057097e-01, -4.87084001e-01, -1.12710059e+00, -1.50304168e-01,
        1.61905125e-01, -1.06376088e+00, -1.79474366e+00, -2.47142529e+00,
       -1.37955105e+00, -5.30928195e-01, -6.69240892e-01, -7.28397012e-01,
       -1.23146679e-02, -1.91214845e-01, -1.36343765e+00, -6.80291533e-01,
        2.43130490e-01, -2.19189405e+00, -1.30584300e-01, -7.57263079e-02,
       -6.89271092e-01, -5.89975476e-01,  1.30663216e-01,  1.84104770e-01,
       -1.14834416e+00, -4.25987750e-01,  1.42449999e+00, -6.64582133e-01,
       -7.43101776e-01, -4.40113574e-01, -1.27447820e+00,  2.25343466e-01,
       -7.00937212e-01,  1.55247692e-02, -7.34718144e-01, -1.24533486e+00,
       -3.56478572e-01, -7.89968073e-01, -1.19486354e-01, -1.06655657e+00,
       -6.12425566e-01, -8.31932783e-01, -1.43601298e-01, -2.73370683e-01,
       -6.84227705e-01, -1.36233854e+00, -1.66018474e+00,  2.53030509e-01,
       -1.12777936e+00, -3.82517338e-01,  5.35819411e-01, -9.75594640e-01,
        6.79300070e-01, -4.62955594e-01, -1.51971149e+00,  4.08621550e-01,
        1.57021120e-01, -2.30584431e+00, -9.06328797e-01, -1.27960527e+00,
       -1.32934308e+00, -2.21897796e-01, -1.63237572e+00, -8.00375566e-02,
       -1.27441084e+00, -8.71193409e-01,  1.00397371e-01, -1.11549473e+00,
       -3.63808721e-02, -6.25247240e-01,  2.90334642e-01, -1.14464879e+00,
       -1.61532032e+00, -2.44415855e+00, -1.49570370e+00, -2.27996465e-02,
       -3.93138081e-01,  5.28001785e-01, -5.02933621e-01, -9.32302892e-01,
       -5.15582442e-01,  4.91010584e-03,  1.56960472e-01, -1.32335246e+00,
       -1.27045965e+00, -1.75009525e+00,  1.52582899e-01, -1.01222849e+00,
       -5.70716560e-01,  1.52745638e-02, -4.06353801e-01, -1.48798621e+00,
       -8.52519833e-03, -7.68263876e-01, -2.31708840e-01, -2.20493078e+00,
       -1.98475480e+00, -2.44697571e-01, -1.35865724e+00, -1.05699646e+00,
       -6.92480206e-01,  7.95379519e-01, -7.57232308e-01, -1.47273946e+00,
        1.06639159e+00, -5.86596608e-01, -9.04355586e-01, -3.95438999e-01,
       -2.04357362e+00, -5.08152306e-01, -1.43346086e-01, -3.70487839e-01,
       -1.48757970e+00, -1.06607854e+00,  1.88260838e-01, -1.44665051e+00,
        3.04605097e-01, -1.60378814e+00, -1.25550985e+00, -6.60950243e-01,
       -5.09707153e-01, -1.15744567e+00,  5.53921387e-02, -1.49579620e+00,
       -1.98649263e+00, -1.24225414e+00, -1.04710340e+00, -4.75223392e-01,
       -1.11833620e+00, -1.60117853e+00, -7.79619336e-01, -4.85702723e-01,
       -2.42417240e+00, -1.11450708e+00, -2.63645828e-01, -9.99009162e-02,
        9.91008282e-01, -5.55940270e-01,  7.53347576e-02, -3.14782351e-01,
       -1.51843286e+00, -3.85351717e-01, -1.21024740e+00, -7.56441116e-01,
       -6.25082135e-01, -1.14212048e+00, -9.07082379e-01,  4.42242026e-01,
       -5.82064152e-01, -5.88659465e-01, -1.22716248e+00, -3.16576332e-01,
       -1.28380895e+00, -6.81537986e-01, -1.05998136e-01, -1.61238599e+00,
       -1.52761245e+00,  7.50160456e-01, -7.61585295e-01, -4.21560735e-01,
       -8.55210960e-01,  4.43484038e-01, -3.71892869e-01, -2.55236834e-01,
       -1.00304222e+00,  5.97988069e-02, -1.48603213e+00,  6.60688996e-01,
       -2.98359673e-02, -5.15780807e-01, -1.14842758e-01, -6.68081760e-01,
        5.96599653e-02, -1.08117849e-01, -1.17578268e+00, -1.98117897e-01,
        2.79609025e-01, -9.61568475e-01, -8.26267838e-01, -1.67182660e+00,
       -8.13839197e-01,  2.49323383e-01,  1.99938998e-01, -7.61646926e-01,
       -2.66883820e-01, -1.25724578e+00, -1.73139429e+00, -4.49329287e-01,
       -1.07266378e+00, -7.05053031e-01, -1.64039060e-01,  1.26850486e-01,
       -1.10991240e+00, -1.58053529e+00, -7.17704356e-01, -4.66895312e-01,
        5.66047132e-01,  4.27735075e-02, -2.29824877e+00, -1.59260750e+00,
        3.20180595e-01, -1.11754811e+00, -1.40600160e-01,  1.47560489e+00,
       -1.34390748e+00, -1.53548825e+00, -1.57401359e+00, -1.55890489e+00,
       -1.35571611e+00, -1.21557033e+00, -1.10422540e+00, -7.98033774e-01,
        1.64072458e-02, -1.13948512e+00,  1.02378912e-01,  2.74432451e-01,
       -3.90287668e-01, -6.95743978e-01, -7.31726065e-02, -1.71617925e-01,
        1.11231887e+00, -2.61531115e+00, -6.87589169e-01, -1.48117983e+00,
       -7.08065689e-01, -7.71271110e-01, -4.10109684e-02, -2.51614004e-01,
       -6.44723535e-01, -1.03980851e+00, -2.00961614e+00,  2.00765535e-01,
        3.87469739e-01, -1.35863519e+00, -1.04076636e+00, -9.52581987e-02,
       -7.58747876e-01, -3.07883602e-02,  1.43601075e-01,  4.56660420e-01,
       -2.63463464e-02, -1.01897228e+00,  2.64919460e-01,  5.30381441e-01,
       -9.85123277e-01, -4.42958847e-02,  3.06179345e-01,  2.94515997e-01,
       -8.45378160e-01, -3.89476269e-01, -1.21107137e+00,  4.78789583e-02,
       -8.81342471e-01, -2.85949081e-01,  5.49493670e-01, -1.35954440e+00,
       -1.60876453e-01,  8.97906646e-02, -1.10278451e+00, -1.70498407e+00,
        4.80590016e-01, -4.07304130e-02,  4.91890609e-02, -1.32066107e+00,
       -3.76419351e-02, -6.44168496e-01, -1.38171613e+00, -8.26427788e-02,
       -6.10931218e-01, -1.40120041e+00, -3.08215231e-01,  5.30093133e-01,
        1.75871223e-01, -1.98728716e+00, -8.32749963e-01, -7.99701214e-01,
       -5.93321502e-01, -6.01581812e-01, -3.32143277e-01, -2.27918530e+00,
        5.42986766e-02, -1.59474686e-01, -9.63378847e-01, -1.77002147e-01,
       -5.24819672e-01, -1.14627862e+00, -1.86629504e-01,  7.92855442e-01,
       -2.31432915e-01, -1.22256315e+00, -2.33217835e+00, -1.84998536e+00,
       -1.46911860e+00, -3.31120640e-01, -1.83041364e-01,  3.25969845e-01,
       -1.63662171e+00, -1.42739749e+00, -2.31113625e+00, -4.96224403e-01,
       -6.25783682e-01, -3.67221206e-01, -1.09744763e+00, -1.30879772e+00,
       -2.69991368e-01, -8.10768962e-01, -3.03866088e-01, -1.55415308e+00,
       -6.82921767e-01, -4.37842339e-01,  8.71351361e-01, -1.55550241e+00,
       -9.23996627e-01, -4.50632423e-01,  3.40378851e-01,  2.67254084e-01,
       -5.82832932e-01, -4.46096689e-01, -4.37032640e-01, -1.50825870e+00,
       -6.59522653e-01, -1.29570341e+00, -8.01640987e-01,  4.16724652e-01,
       -2.02207398e+00, -1.23752582e+00, -8.76179755e-01, -1.94472209e-01,
       -6.47979259e-01,  5.81784472e-02, -1.23952031e+00,  8.26443806e-02,
       -1.03363669e+00, -1.06226742e+00, -2.79000330e+00, -5.63263655e-01,
       -9.73864421e-02, -1.53294027e+00, -1.36386561e+00,  3.03838521e-01,
       -8.94639611e-01, -1.02332115e+00, -1.99361575e+00, -9.37528074e-01,
        1.33576667e+00, -4.72740978e-01, -2.85640746e-01, -9.54766214e-01,
        4.11498427e-01, -1.20488608e+00,  4.54647630e-01, -4.57800180e-01,
       -2.55620450e-01, -3.69434208e-02, -3.38575274e-01, -6.69488534e-02,
       -3.42400283e-01, -7.70457745e-01, -1.37624478e+00, -1.02260458e+00,
       -1.42712021e+00, -2.86574095e-01,  5.73815465e-01, -1.70989931e+00,
       -1.66565433e-01, -5.05893588e-01, -6.35827422e-01, -6.37958229e-01,
       -6.96652412e-01, -1.05046976e+00, -1.58760560e+00, -1.98444057e+00,
       -3.59003663e-01, -1.82456005e+00,  3.47209752e-01, -1.63245142e-01,
       -7.11828649e-01, -1.10710359e+00, -1.06666088e+00, -1.77169812e+00,
       -2.00812206e-01, -5.29518068e-01, -4.74233449e-01, -9.71334279e-01,
       -2.64782041e-01, -1.60693121e+00, -3.15377593e-01, -1.30195761e+00,
        2.29412299e-02,  6.58942945e-03,  9.10918042e-02, -4.04364794e-01,
       -2.43318605e+00, -2.85756499e-01, -7.47038484e-01, -1.73783624e+00,
        4.33603793e-01, -2.85559386e-01, -3.53678256e-01, -3.95902842e-01,
        5.34145057e-01, -1.43145692e+00, -1.61604917e+00,  3.32968563e-01,
       -1.16217518e+00, -2.37112716e-01, -2.08028364e+00, -4.71484333e-01,
       -1.68646753e+00, -5.51262021e-01, -8.83804381e-01, -9.40573812e-01,
       -5.09940207e-01, -1.13948894e+00, -2.35137773e+00, -3.94834369e-01,
       -1.75958216e-01, -1.65760672e+00, -5.06069064e-01, -1.37112951e+00,
       -5.57330772e-02, -5.14550924e-01,  4.20008630e-01, -4.93893594e-01,
       -1.17026484e+00, -1.17418230e+00, -5.04343629e-01, -6.09254003e-01,
       -3.34616393e-01, -5.78159928e-01, -1.62669945e+00, -1.84896553e+00,
       -1.00113678e+00, -1.31941330e+00, -1.24606431e+00, -3.05965364e-01,
        3.82845879e-01, -8.21524858e-01,  6.68448582e-02, -1.80219516e-01,
       -1.85848486e+00, -1.45307589e+00, -1.34457076e+00, -1.32339406e+00,
       -9.60362673e-01, -1.11133349e+00, -8.66961598e-01, -1.57259619e+00,
       -5.24168491e-01,  6.26402259e-01, -1.36977589e+00, -8.33411694e-01,
        1.97536692e-01, -2.40961313e+00,  7.42201030e-01, -1.07348728e+00,
       -9.56145227e-01, -1.56055462e+00, -7.94523180e-01,  7.61410072e-02,
        5.84067166e-01,  1.49686754e-01, -1.72177124e+00,  1.33228704e-01,
       -5.52492321e-01,  4.96392399e-01, -7.71470010e-01, -9.99654770e-01,
       -1.27416360e+00,  4.83619645e-02, -9.92125198e-02, -3.50110605e-02,
       -8.83845091e-01, -9.43352163e-01, -1.11279058e+00,  7.45177269e-01,
       -6.72689855e-01, -1.39633977e+00, -7.55037725e-01, -8.62410426e-01,
       -1.22134852e+00,  4.33723480e-01, -7.53100589e-02, -1.81683147e+00,
       -4.36181396e-01,  1.62774399e-01, -1.03966117e-01, -5.01695216e-01,
        8.47375616e-02, -8.29446256e-01, -1.57955170e+00,  3.13992828e-01,
       -1.32061803e+00, -1.17332542e+00, -1.12760198e+00, -1.47840202e+00,
       -1.19623378e-01, -1.70588124e+00, -4.29553062e-01, -9.49124336e-01,
       -1.04503345e+00,  5.47630191e-01, -2.53590107e-01, -1.08113980e+00,
       -2.29097232e-01, -7.83388615e-01, -7.10676193e-01, -7.73506999e-01,
       -1.13012958e-02, -1.36104703e+00, -7.83111453e-01, -1.01781476e+00,
       -6.29919171e-01, -4.52548742e-01, -1.45552278e+00, -1.17971802e+00,
       -9.41289067e-01, -3.36862892e-01, -9.69080687e-01, -3.34786505e-01,
       -1.12180543e+00, -5.56561589e-01, -1.77431464e+00, -2.90072322e-01,
        6.58976659e-02,  1.76239628e-02,  6.01842523e-01, -7.45936275e-01,
       -3.38315457e-01,  1.04028724e-01, -6.79869235e-01, -3.20427805e-01,
       -2.31927490e+00, -2.73363918e-01, -5.64876080e-01,  2.58184761e-01,
       -1.01983547e+00, -2.41250932e-01, -2.43057251e+00, -1.57770142e-01,
        1.60587020e-03, -1.36574149e+00, -1.88157022e+00,  3.62062246e-01,
       -1.68959093e+00, -7.31377065e-01, -2.63444114e+00, -4.65355307e-01,
       -5.95395505e-01, -1.54789007e+00, -1.42604363e+00, -1.25343883e+00,
       -1.71507180e+00,  2.14178815e-01, -1.73056865e+00, -2.02364087e+00,
       -7.09609807e-01,  2.87615150e-01, -6.38848364e-01, -9.16678488e-01,
       -1.79437709e+00, -2.35329643e-01, -2.29717031e-01,  1.57455587e+00,
       -1.09135079e+00, -3.03741872e-01, -9.48603392e-01,  2.76924204e-02,
       -1.79336131e+00, -8.37808609e-01, -1.55691147e-01, -7.30212867e-01],
      dtype=float32)
</pre></div></div>
</div>
</div>
<div class="section" id="4.2-Saving-using-Keras'-saving-methods">
<h3>4.2 Saving using Keras’ saving methods<a class="headerlink" href="#4.2-Saving-using-Keras'-saving-methods" title="Permalink to this headline">¶</a></h3>
<p>This efficiently and safely saves the model to disk, including trained weights. You should use this method if you plan on sharing your saved models.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Save to disk</span>
<span class="n">pred_old</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_regr</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">model_</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;/tmp/my_model&quot;</span><span class="p">)</span>  <span class="c1"># saves just the Keras model</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
32/32 [==============================] - 0s 769us/step
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Load the model back into memory</span>
<span class="n">new_reg_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;/tmp/my_model&quot;</span><span class="p">)</span>
<span class="c1"># Now we need to instantiate a new SciKeras object</span>
<span class="c1"># since we only saved the Keras model</span>
<span class="n">reg_new</span> <span class="o">=</span> <span class="n">KerasRegressor</span><span class="p">(</span><span class="n">new_reg_model</span><span class="p">)</span>
<span class="c1"># use initialize to avoid re-fitting</span>
<span class="n">reg_new</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">X_regr</span><span class="p">,</span> <span class="n">y_regr</span><span class="p">)</span>
<span class="n">pred_new</span> <span class="o">=</span> <span class="n">reg_new</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_regr</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">pred_old</span><span class="p">,</span> <span class="n">pred_new</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
32/32 [==============================] - 0s 626us/step
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="5.-Usage-with-an-sklearn-Pipeline">
<h2>5. Usage with an sklearn Pipeline<a class="headerlink" href="#5.-Usage-with-an-sklearn-Pipeline" title="Permalink to this headline">¶</a></h2>
<p>It is possible to put the <code class="docutils literal notranslate"><span class="pre">KerasClassifier</span></code> inside an <code class="docutils literal notranslate"><span class="pre">sklearn</span> <span class="pre">Pipeline</span></code>, as you would with any <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> classifier.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>


<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">clf</span><span class="p">),</span>
<span class="p">])</span>


<span class="n">y_proba</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
32/32 [==============================] - 1s 1ms/step - loss: 0.7113
32/32 [==============================] - 0s 786us/step
</pre></div></div>
</div>
<p>To save the whole pipeline, including the Keras model, use <code class="docutils literal notranslate"><span class="pre">pickle</span></code>.</p>
</div>
<div class="section" id="6.-Callbacks">
<h2>6. Callbacks<a class="headerlink" href="#6.-Callbacks" title="Permalink to this headline">¶</a></h2>
<p>Adding a new callback to the model is straightforward. Below we define a threashold callback to avoid training past a certain accuracy. This a rudimentary for of <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping">early stopping</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">MaxValLoss</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">Callback</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monitor</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">threashold</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span> <span class="o">=</span> <span class="n">monitor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threashold</span> <span class="o">=</span> <span class="n">threashold</span>

    <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">logs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threashold</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Threashold reached; stopping training&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">stop_training</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<p>Define a test dataset:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And try fitting it with and without the callback:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">get_clf</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;binary_crossentropy&quot;</span><span class="p">,</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;binary_accuracy&quot;</span><span class="p">],</span>
    <span class="n">fit__validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>

<span class="c1"># First test without the callback</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trained </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">history_</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> epochs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final accuracy: </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">history_</span><span class="p">[</span><span class="s1">&#39;val_binary_accuracy&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># get last value of last fit/partial_fit call</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Trained 20 epochs
Final accuracy: 1.0
</pre></div></div>
</div>
<p>And with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Test with the callback</span>

<span class="n">cb</span> <span class="o">=</span> <span class="n">MaxValLoss</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_binary_accuracy&quot;</span><span class="p">,</span> <span class="n">threashold</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">cb</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trained </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">history_</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> epochs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final accuracy: </span><span class="si">{</span><span class="n">clf</span><span class="o">.</span><span class="n">history_</span><span class="p">[</span><span class="s1">&#39;val_binary_accuracy&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># get last value of last fit/partial_fit call</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Threashold reached; stopping training
Trained 2 epochs
Final accuracy: 0.949999988079071
</pre></div></div>
</div>
<p>For information on how to write custom callbacks, have a look at the <a class="reference external" href="https://nbviewer.jupyter.org/github/adriangb/scikeras/blob/master/notebooks/Advanced_Usage.ipynb">Advanced Usage</a> notebook.</p>
</div>
<div class="section" id="7.-Usage-with-sklearn-GridSearchCV">
<h2>7. Usage with sklearn GridSearchCV<a class="headerlink" href="#7.-Usage-with-sklearn-GridSearchCV" title="Permalink to this headline">¶</a></h2>
<div class="section" id="7.1-Special-prefixes">
<h3>7.1 Special prefixes<a class="headerlink" href="#7.1-Special-prefixes" title="Permalink to this headline">¶</a></h3>
<p>SciKeras allows to direct access to all parameters passed to the wrapper constructors, including deeply nested routed parameters. This allows tunning of paramters like <code class="docutils literal notranslate"><span class="pre">hidden_layer_sizes</span></code> as well as <code class="docutils literal notranslate"><span class="pre">optimizer__learning_rate</span></code>.</p>
<p>This is exactly the same logic that allows to access estimator parameters in <code class="docutils literal notranslate"><span class="pre">sklearn</span> <span class="pre">Pipeline</span></code>s and <code class="docutils literal notranslate"><span class="pre">FeatureUnion</span></code>s.</p>
<p>This feature is useful in several ways. For one, it allows to set those parameters in the model definition. Furthermore, it allows you to set parameters in an <code class="docutils literal notranslate"><span class="pre">sklearn</span> <span class="pre">GridSearchCV</span></code> as shown below.</p>
<p>To differentiate paramters like <code class="docutils literal notranslate"><span class="pre">callbacks</span></code> which are accepted by both <code class="docutils literal notranslate"><span class="pre">tf.keras.Model.fit</span></code> and <code class="docutils literal notranslate"><span class="pre">tf.keras.Model.predict</span></code> you can add a <code class="docutils literal notranslate"><span class="pre">fit__</span></code> or <code class="docutils literal notranslate"><span class="pre">predict__</span></code> routing suffix respectively. Similar, the <code class="docutils literal notranslate"><span class="pre">model__</span></code> prefix may be used to specify that a paramter is destined only for <code class="docutils literal notranslate"><span class="pre">get_clf</span></code>/<code class="docutils literal notranslate"><span class="pre">get_reg</span></code> (or whatever callable you pass as your <code class="docutils literal notranslate"><span class="pre">model</span></code> argument).</p>
<p>For more information on parameter routing with special prefixes, see the <a class="reference external" href="https://scikeras.org.readthedocs.build/en/latest/advanced.html#routed-parameters">Advanced Usage Docs</a></p>
</div>
<div class="section" id="7.2-Performing-a-grid-search">
<h3>7.2 Performing a grid search<a class="headerlink" href="#7.2-Performing-a-grid-search" title="Permalink to this headline">¶</a></h3>
<p>Below we show how to perform a grid search over the learning rate (<code class="docutils literal notranslate"><span class="pre">optimizer__lr</span></code>), the model’s number of hidden layers (<code class="docutils literal notranslate"><span class="pre">model__hidden_layer_sizes</span></code>), the model’s dropout rate (<code class="docutils literal notranslate"><span class="pre">model__dropout</span></code>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">get_clf</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;binary_crossentropy&quot;</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span>
    <span class="n">optimizer__lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">model__hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,),</span>
    <span class="n">model__dropout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p><em>Note</em>: We set the verbosity level to zero (<code class="docutils literal notranslate"><span class="pre">verbose=False</span></code>) to prevent too much print output from being shown.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;optimizer__lr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
    <span class="s1">&#39;model__hidden_layer_sizes&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="mi">100</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="p">)],</span>
    <span class="s1">&#39;model__dropout&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="p">}</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fitting 5 folds for each of 8 candidates, totalling 40 fits
0.86 {&#39;model__dropout&#39;: 0, &#39;model__hidden_layer_sizes&#39;: (50, 50), &#39;optimizer__lr&#39;: 0.05}
</pre></div></div>
</div>
<p>Of course, we could further nest the <code class="docutils literal notranslate"><span class="pre">KerasClassifier</span></code> within an <code class="docutils literal notranslate"><span class="pre">sklearn.pipeline.Pipeline</span></code>, in which case we just prefix the parameter by the name of the net (e.g. <code class="docutils literal notranslate"><span class="pre">clf__model__hidden_layer_sizes</span></code>).</p>
</div>
</div>
</div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <nav class="relbar">
      <a class="previous" href="../tutorials.html" aria-label="Previous topic" >
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"/></svg>
        </div>
        <div class="title">
          <span class="text">
            <span class="direction">previous</span>
            Tutorials
          </span>
        </div>
      </a>
      <a class="next" href="MLPClassifier_MLPRegressor.html" aria-label="Next topic" >
        <div class="title">
          <span class="text">
            <span class="direction">next</span>
            MLPClassifier and MLPRegressor in SciKeras
          </span>
        </div>
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"/></svg>
        </div>
      </a>
    </nav>


      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

          <div class="sidebar-resize-handle"></div>

<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration.html">Migrating from <code class="docutils literal notranslate"><span class="pre">tf.keras.wrappers.scikit_learn</span></code></a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basic usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="MLPClassifier_MLPRegressor.html">MLPClassifier and MLPRegressor in SciKeras</a></li>
<li class="toctree-l2"><a class="reference internal" href="Meta_Estimators.html">Meta Estimators in SciKeras</a></li>
<li class="toctree-l2"><a class="reference internal" href="DataTransformers.html">Data Transformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="AutoEncoders.html">Autoencoders in SciKeras</a></li>
<li class="toctree-l2"><a class="reference internal" href="Benchmarks.html">SciKeras Benchmarks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced.html">Advanced Usage of SciKeras Wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">SciKeras API</a></li>
</ul>

<hr class="docutils" />
<ul>
  <li class="toctree-l1"><a class="reference internal" href="../genindex.html" accesskey="I">General Index</a></li>
  <li class="toctree-l1"><a class="reference internal" href="../py-modindex.html">Python Module Index</a></li>
</ul>
<div id="ethical-ad-placement"></div>
        </div>
      </div>
    <footer role="contentinfo">
      &#169; Copyright 2020, SciKeras Developers.
      Created using <a class="reference external" href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
      <a class="reference external" href="https://insipid-sphinx-theme.readthedocs.io/">Insipid Theme</a>.
<a class="reference internal" href="../_sources/notebooks/Basic_Usage.ipynb.txt" rel="nofollow">Show Source</a>.
    </footer>
    <div class="sidebar-resize-handle"></div>
    <div id="overlay"></div>
  </body>
</html>